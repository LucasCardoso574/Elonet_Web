---
interface Props {
  currentPath?: string;
}

const { currentPath = Astro.url.pathname } = Astro.props;
---

<header class="header">
  <div class="header-container">
      <a href="/" class="header-logo">
        <img src="/images/logo.png" alt="Elonet Habitação" class="logo-image" />
      </a>
    
    <nav class="header-nav">
      <a href="/" class={`nav-link ${currentPath === '/' ? 'active' : ''}`}>Home</a>
      <a href="/quem-somos" class={`nav-link ${currentPath === '/quem-somos' ? 'active' : ''}`}>Quem Somos</a>
      <a href="/solucoes" class={`nav-link ${currentPath === '/solucoes' ? 'active' : ''}`}>Soluções</a>
      <a href="/casos-de-sucesso" class={`nav-link ${currentPath === '/casos-de-sucesso' ? 'active' : ''}`}>Casos de Sucesso</a>
      <a href="/noticias" class={`nav-link ${currentPath === '/noticias' || currentPath.startsWith('/noticias/') ? 'active' : ''}`}>Notícias</a>
      <a href="/contato" class={`nav-link ${currentPath === '/contato' ? 'active' : ''}`}>Contato</a>
    </nav>
    
    <div class="header-actions">
      <a href="#" class="btn-primary">Área do Cliente SIAR</a>
      <button class="mobile-menu-btn" id="mobile-menu-btn" aria-label="Menu mobile" aria-expanded="false" onclick="toggleMobileMenu()">
        <span class="material-symbols-outlined menu-icon">menu</span>
        <span class="material-symbols-outlined close-icon">close</span>
      </button>
    </div>
  </div>
</header>

<!-- Mobile Menu será criado dinamicamente via JavaScript -->

<style>
  .header {
    position: sticky;
    top: 0;
    z-index: var(--z-sticky);
    width: 100%;
    border-bottom: 1px solid var(--color-gray-200);
    background-color: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(12px);
  }
  
  .header-container {
    display: flex;
    height: 4.5rem; /* 90% de 5rem */
    max-width: var(--container-max-width);
    margin-left: auto;
    margin-right: auto;
    padding-left: var(--container-padding);
    padding-right: var(--container-padding);
    align-items: center;
    justify-content: space-between;
  }
  
      .header-logo {
        display: flex;
        align-items: center;
        gap: var(--spacing-3);
        transition: opacity var(--transition-fast);
      }
      
      .header-logo:hover {
        opacity: 0.8;
      }
  
  .logo-image {
    display: block;
  }
  
  .logo-text {
    display: flex;
    flex-direction: column;
  }
  
  .logo-title {
    font-size: 1.25rem;
    font-weight: var(--font-weight-bold);
    letter-spacing: -0.025em;
    color: var(--color-institutional);
    margin: 0;
    line-height: 1.2;
  }
  
  .logo-subtitle {
    font-size: 0.75rem;
    font-weight: var(--font-weight-medium);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--color-gray-500);
  }
  
  .header-nav {
    display: none;
    align-items: center;
    gap: var(--spacing-8);
  }
  
  @media (min-width: 768px) {
    .header-nav {
      display: flex;
    }
  }
  
      .nav-link {
        font-size: 0.9375rem;
        font-weight: var(--font-weight-semibold);
        color: var(--color-gray-700);
        padding: var(--spacing-2) 0;
        position: relative;
        transition: color var(--transition-fast);
      }
      
      .nav-link::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        width: 0;
        height: 2px;
        background-color: var(--color-institutional);
        transition: width var(--transition-base);
      }
      
      .nav-link:hover {
        color: var(--color-institutional);
      }
      
      .nav-link:hover::after {
        width: 100%;
      }
      
      .nav-link.active {
        color: var(--color-institutional);
        font-weight: var(--font-weight-bold);
      }
      
      .nav-link.active::after {
        width: 100%;
      }
  
  .header-actions {
    display: flex;
    align-items: center;
    gap: var(--spacing-4);
  }
  
  .btn-primary {
    display: none;
    align-items: center;
    justify-content: center;
    padding: 0.625rem 1.25rem;
    border-radius: var(--radius-lg);
    background-color: var(--color-institutional);
    color: white;
    font-size: 0.875rem;
    font-weight: var(--font-weight-bold);
    transition: all var(--transition-base);
  }
  
  @media (min-width: 768px) {
    .btn-primary {
      display: inline-flex;
    }
  }
  
  .btn-primary:hover {
    background-color: var(--color-institutional-hover);
  }
  
  .btn-primary:focus-visible {
    outline: 2px solid var(--color-institutional);
    outline-offset: 2px;
  }
  
  .mobile-menu-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-2);
    color: var(--color-gray-600);
    transition: color var(--transition-fast);
    position: relative;
    width: 2.5rem;
    height: 2.5rem;
  }
  
  .mobile-menu-btn:hover {
    color: var(--color-institutional);
  }
  
  .mobile-menu-btn .close-icon {
    display: none;
  }
  
  .mobile-menu-btn[aria-expanded="true"] .menu-icon {
    display: none;
  }
  
  .mobile-menu-btn[aria-expanded="true"] .close-icon {
    display: block;
  }
  
  @media (min-width: 768px) {
    .mobile-menu-btn {
      display: none;
    }
  }
  
  /* CSS do menu mobile foi movido para <style is:global> porque é criado dinamicamente */
</style>

<!-- CSS do menu mobile está em /src/styles/mobile-menu.css e é importado no Layout.astro -->

<script is:inline>
  // Dados do menu - currentPath será definido abaixo
  const menuData = {
    currentPath: '',
    links: [
      { href: '/', label: 'Home' },
      { href: '/quem-somos', label: 'Quem Somos' },
      { href: '/solucoes', label: 'Soluções' },
      { href: '/casos-de-sucesso', label: 'Casos de Sucesso' },
      { href: '/noticias', label: 'Notícias' },
      { href: '/contato', label: 'Contato' }
    ]
  };
  
  // Definir currentPath a partir do window.location
  menuData.currentPath = window.location.pathname;

  function createMobileMenu() {
    // Criar menu (overlay removido - sem sombreamento)
    var menu = document.createElement('div');
    menu.id = 'mobile-menu';
    menu.className = 'mobile-menu';
    
    var nav = document.createElement('nav');
    nav.className = 'mobile-nav';
    
    // Adicionar links
    menuData.links.forEach(function(link) {
      var a = document.createElement('a');
      a.href = link.href;
      var isActive = menuData.currentPath === link.href || (link.href === '/noticias' && menuData.currentPath.startsWith('/noticias/'));
      a.className = 'mobile-nav-link' + (isActive ? ' active' : '');
      a.textContent = link.label;
      a.onclick = closeMobileMenu;
      nav.appendChild(a);
    });
    
    // Botão primário
    var btnPrimary = document.createElement('a');
    btnPrimary.href = '#';
    btnPrimary.className = 'mobile-btn-primary';
    btnPrimary.textContent = 'Área do Cliente SIAR';
    btnPrimary.onclick = closeMobileMenu;
    nav.appendChild(btnPrimary);
    
    menu.appendChild(nav);
    document.body.appendChild(menu);
  }

  function toggleMobileMenu() {
    var menu = document.getElementById('mobile-menu');
    var btn = document.getElementById('mobile-menu-btn');
    
    // Criar menu se não existir
    if (!menu) {
      createMobileMenu();
      menu = document.getElementById('mobile-menu');
    }
    
    if (!menu || !btn) return;
    
    var isOpen = menu.classList.contains('is-open');
    
    if (isOpen) {
      menu.classList.remove('is-open');
      menu.style.transform = 'translateX(-100%)';
      btn.setAttribute('aria-expanded', 'false');
      document.body.style.overflow = '';
    } else {
      menu.classList.add('is-open');
      menu.style.transform = 'translateX(0)';
      btn.setAttribute('aria-expanded', 'true');
      document.body.style.overflow = 'hidden';
    }
  }
  
  function closeMobileMenu() {
    var menu = document.getElementById('mobile-menu');
    var btn = document.getElementById('mobile-menu-btn');
    
    if (!menu || !btn) return;
    
    menu.classList.remove('is-open');
    menu.style.transform = 'translateX(-100%)';
    btn.setAttribute('aria-expanded', 'false');
    document.body.style.overflow = '';
  }
  
  // Fechar com ESC
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      var menu = document.getElementById('mobile-menu');
      if (menu && menu.classList.contains('is-open')) {
        closeMobileMenu();
      }
    }
  });
</script>

